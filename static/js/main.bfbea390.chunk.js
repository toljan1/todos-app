(this["webpackJsonpreact-typescript-starter-pack"]=this["webpackJsonpreact-typescript-starter-pack"]||[]).push([[0],{13:function(e,t,n){},20:function(e,t,n){"use strict";n.r(t);n(11),n(12),n(13);var c=n(1),a=n(9),s=n.n(a),r=n(4),i=n.n(r),o=n(5),l=n(10),u=n(2),d="https://mate.academy/students-api";function j(e){return new Promise((function(t){setTimeout(t,e)}))}function b(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"GET",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,c={method:t};return n&&(c.body=JSON.stringify(n),c.headers={"Content-Type":"application/json; charset=UTF-8"}),j(300).then((function(){return fetch(d+e,c)})).then((function(e){if(!e.ok)throw new Error;return e.json()}))}var m,f=function(e){return b(e)},p=function(e,t){return b(e,"POST",t)},h=function(e,t){return b(e,"PATCH",t)},O=function(e){return b(e,"DELETE")},x=n(3),v=n.n(x),g=n(0),N=function(e){var t=e.todos,n=e.tempTodo,a=e.idProcessed,s=e.disableList,r=e.onDelete,i=e.onUpdate,o=e.setIdProcessed,l=Object(c.useState)(0),d=Object(u.a)(l,2),j=d[0],b=d[1],m=Object(c.useState)(""),f=Object(u.a)(m,2),p=f[0],h=f[1],O=function(e){e&&(o([e]),r(e))},x=function(e,t,n){e&&(o([e]),b(0),i(e,t,n))},N=function(e){h(e.currentTarget.value)};return Object(g.jsxs)("section",{className:"todoapp__main is-loading",children:[t.map((function(e){return Object(g.jsxs)("div",{className:v()("todo",{completed:e.completed}),onDoubleClick:function(){h(e.title),b(e.id)},children:[Object(g.jsx)("label",{className:"todo__status-label",children:Object(g.jsx)("input",{type:"checkbox",className:"todo__status",disabled:s,onChange:function(){return x(e.id,e.title,!e.completed)}})}),j!==e.id?Object(g.jsxs)(g.Fragment,{children:[Object(g.jsx)("span",{className:"todo__title",children:e.title}),Object(g.jsx)("button",{type:"button",className:"todo__remove",onClick:function(){return O(e.id)},disabled:s,children:"\xd7"})]}):null,j===e.id?Object(g.jsx)("form",{onSubmit:function(t){var n,c,a;t.preventDefault(),n=e.title,c=e.id,a=e.completed,0!==p.length?p!==n&&p.trim().length&&(x(c,p,a),b(0)):O(c)},children:Object(g.jsx)("label",{children:Object(g.jsx)("input",{type:"text",className:"todo__title-field",id:"".concat(e.id),value:p,onChange:N,onBlur:function(){var t,n,c;if(0!==p.length)return p!==e.title&&p.trim().length?(t=e.id,n=p,c=e.completed,void x(t,n,c)):void b(0);O(e.id)},onKeyUp:function(e){j&&"Escape"===e.key&&b(0)}})})}):null,Object(g.jsxs)("div",{className:v()("modal overlay",{"is-active":a.includes(e.id)}),children:[Object(g.jsx)("div",{className:"modal-background has-background-white-ter"}),Object(g.jsx)("div",{className:"loader"})]})]},e.id)})),n?Object(g.jsxs)("div",{className:v()("todo",{completed:n.completed}),children:[Object(g.jsx)("label",{className:"todo__status-label",children:Object(g.jsx)("input",{type:"checkbox",className:"todo__status"})}),Object(g.jsx)("span",{className:"todo__title",children:n.title}),Object(g.jsx)("button",{type:"button",className:"todo__remove",children:"\xd7"}),Object(g.jsxs)("div",{className:v()("modal overlay",{"is-active":0===n.id}),children:[Object(g.jsx)("div",{className:"modal-background has-background-white-ter"}),Object(g.jsx)("div",{className:"loader"})]})]}):n]})},y=function(e){var t=e.setTitle,n=e.title,c=e.onAdd,a=e.disableForm,s=e.handleToggleAll;return Object(g.jsxs)("header",{className:"todoapp__header",children:[Object(g.jsx)("button",{type:"button",className:"todoapp__toggle-all active","aria-label":"toggle-all",onClick:s}),Object(g.jsx)("form",{onSubmit:function(e){e.preventDefault(),c()},children:Object(g.jsx)("input",{type:"text",className:"todoapp__new-todo",placeholder:"What needs to be done?",value:n,onChange:function(e){return t(e.currentTarget.value)},disabled:a})})]})};!function(e){e.ALL="ALL",e.ACTIVE="ACTIVE",e.COMPLETED="COMPLETED"}(m||(m={}));var _=[{title:"All",id:m.ALL},{title:"Active",id:m.ACTIVE},{title:"Completed",id:m.COMPLETED}],C=function(e){var t=e.setFilterBy,n=e.itemsQuantity,c=e.filterBy,a=e.onClear,s=e.completedLength;return Object(g.jsxs)("footer",{className:"todoapp__footer",children:[Object(g.jsx)("span",{className:"todo-count",children:"".concat(n," items left")}),Object(g.jsx)("nav",{className:"filter",children:_.map((function(e){return Object(g.jsx)("a",{href:"#/",id:e.id,className:v()("filter__link",{selected:c===e.id}),onClick:(n=e.id,function(){switch(n){case m.ACTIVE:t(m.ACTIVE);break;case m.COMPLETED:t(m.COMPLETED);break;default:t(m.ALL)}}),children:e.title},e.id);var n}))}),s?Object(g.jsx)("button",{type:"button",className:"todoapp__clear-completed",onClick:a,children:"Clear completed"}):null]})},E=function(e){var t=e.onClose,n=e.error;return Object(g.jsxs)("div",{className:v()("notification","is-danger","is-light","has-text-weight-normal",{hidden:!n}),children:[Object(g.jsx)("button",{type:"button","aria-label":null!==n&&void 0!==n?n:"",className:"delete",onClick:function(){return t(null)}}),n]})},k=function(){var e=Object(o.a)(i.a.mark((function e(t){var n;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,f("/users?email=".concat(t));case 2:return n=e.sent,e.abrupt("return",n[0]||null);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),L=function(){var e=Object(o.a)(i.a.mark((function e(t){var n,c;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.email,c=t.name,e.abrupt("return",p("/users",{email:n,name:c}));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),T=function(e){var t=e.setUser,n=Object(c.useState)(""),a=Object(u.a)(n,2),s=a[0],r=a[1],l=Object(c.useState)(""),d=Object(u.a)(l,2),j=d[0],b=d[1],m=Object(c.useState)(!1),f=Object(u.a)(m,2),p=f[0],h=f[1],O=Object(c.useState)(!1),x=Object(u.a)(O,2),N=x[0],y=x[1],_=Object(c.useState)(""),C=Object(u.a)(_,2),E=C[0],T=C[1];function S(e){t(e),localStorage.setItem("user",JSON.stringify(e))}function w(){return L({name:j,email:s}).then(S).catch((function(){T("Can't create a user")}))}function A(){return k(s).then((function(e){e?S(e):h(!0)})).catch((function(){T("Can't create a user")}))}function I(){return(I=Object(o.a)(i.a.mark((function e(){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(y(!0),!p){e.next=6;break}return e.next=4,w();case 4:e.next=8;break;case 6:return e.next=8,A();case 8:y(!1);case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(g.jsx)("section",{className:"container is-flex is-justify-content-center",children:Object(g.jsxs)("form",{onSubmit:function(e){e.preventDefault(),function(){I.apply(this,arguments)}()},className:"box mt-5",children:[Object(g.jsx)("h1",{className:"title is-3",children:p?"You need to register":"Get your userId"}),Object(g.jsxs)("div",{className:"field",children:[Object(g.jsx)("label",{className:"label",htmlFor:"user-email",children:"Email"}),Object(g.jsxs)("div",{className:v()("control has-icons-left",{"is-loading":N}),children:[Object(g.jsx)("input",{type:"email",id:"user-email",name:"email",className:v()("input",{"is-danger":!p&&E}),placeholder:"Enter your email",disabled:N||p,value:s,required:!0,onChange:function(e){return r(e.target.value)}}),Object(g.jsx)("span",{className:"icon is-small is-left",children:Object(g.jsx)("i",{className:"fas fa-envelope"})})]}),!p&&E&&Object(g.jsx)("p",{className:"help is-danger",children:E})]}),p&&Object(g.jsxs)("div",{className:"field",children:[Object(g.jsx)("label",{className:"label",htmlFor:"user-name",children:"Your Name"}),Object(g.jsxs)("div",{className:v()("control has-icons-left",{"is-loading":N}),children:[Object(g.jsx)("input",{type:"text",id:"user-name",name:"name",className:v()("input",{"is-danger":p&&E}),placeholder:"Enter your name",required:!0,minLength:4,disabled:N,value:j,onChange:function(e){return b(e.target.value)}}),Object(g.jsx)("span",{className:"icon is-small is-left",children:Object(g.jsx)("i",{className:"fas fa-user"})})]}),p&&E&&Object(g.jsx)("p",{className:"help is-danger",children:E})]}),Object(g.jsx)("div",{className:"field",children:Object(g.jsx)("button",{type:"submit",className:v()("button is-primary",{"is-loading":N}),children:p?"Register":"Login"})})]})})},S=function(){var e=Object(c.useState)([]),t=Object(u.a)(e,2),n=t[0],a=t[1],s=Object(c.useState)(null),r=Object(u.a)(s,2),d=r[0],j=r[1],b=Object(c.useState)(m.ALL),x=Object(u.a)(b,2),v=x[0],_=x[1],k=Object(c.useState)(null),L=Object(u.a)(k,2),S=L[0],w=L[1],A=Object(c.useState)(""),I=Object(u.a)(A,2),D=I[0],P=I[1],F=Object(c.useState)(!1),U=Object(u.a)(F,2),M=U[0],B=U[1],V=Object(c.useState)([0]),J=Object(u.a)(V,2),q=J[0],G=J[1],Q=Object(c.useState)(!1),Y=Object(u.a)(Q,2),H=Y[0],K=Y[1],R=function(e,t){switch(t){case m.ACTIVE:return e.filter((function(e){return!e.completed}));case m.COMPLETED:return e.filter((function(e){return e.completed}));default:return e}}(n,v),W=Object(c.useState)((function(){var e=localStorage.getItem("user");return e?JSON.parse(e):null})),z=Object(u.a)(W,2),X=z[0],Z=z[1],$=X?X.id:null,ee=function(){var e;$&&(e=$,f("/todos?userId=".concat(e))).then((function(e){a(e),G([0])})).catch((function(e){j((null===e||void 0===e?void 0:e.message)?e.message:"Something went wrong")}))};Object(c.useEffect)(ee,[$]);var te=function(e){e&&(K(!0),function(e){return O("/todos/".concat(e))}("".concat(e)).then((function(){ee(),K(!1)})).catch((function(){j("Unable to delete a todo"),K(!1)})))},ne=function(e,t,n){e&&(K(!0),function(e,t){return h("/todos/".concat(e),t)}("".concat(e),{completed:n,title:t}).then((function(){ee(),K(!1)})).catch((function(){j("Unable to update a todo"),K(!1),G([0])})))},ce=Object(c.useMemo)((function(){return n.filter((function(e){return e.completed}))}),[n]),ae=Object(c.useCallback)(Object(o.a)(i.a.mark((function e(){var t;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=ce.map((function(e){return e.id})),G(t),ce.forEach((function(e){e.id&&te(e.id)}));case 3:case"end":return e.stop()}}),e)}))),[ce]),se=Object(c.useMemo)((function(){return n.filter((function(e){return!e.completed}))}),[n]),re=Object(c.useCallback)(Object(o.a)(i.a.mark((function e(){var t;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!se.length){e.next=5;break}return t=se.map((function(e){return e.id})),G(t),se.forEach((function(e){return ne(e.id,e.title,!e.completed)})),e.abrupt("return");case 5:t=n.map((function(e){return e.id})),G(t),n.forEach((function(e){return ne(e.id,e.title,!e.completed)}));case 8:case"end":return e.stop()}}),e)}))),[se]);return $?Object(g.jsxs)("div",{className:"todoapp",children:[Object(g.jsx)("h1",{className:"todoapp__title",children:"todos"}),Object(g.jsxs)("div",{className:"todoapp__content",children:[Object(g.jsx)(y,{setTitle:P,title:D,onAdd:function(){var e,t;D&&(w({id:0,userId:$,title:D,completed:!1}),B(!0),(e=$,t={userId:$,title:D,completed:!1},p("/todos?userId=".concat(e),t)).then((function(e){a([].concat(Object(l.a)(n),[e])),w(null),B(!1),P("")})).catch((function(){w(null),B(!1),j("Unable to add a todo")})))},disableForm:M,handleToggleAll:re}),n.length?Object(g.jsxs)(g.Fragment,{children:[Object(g.jsx)(N,{todos:v!==m.ALL?R:n,tempTodo:S,idProcessed:q,disableList:H,onDelete:te,onUpdate:ne,setIdProcessed:G}),Object(g.jsx)(C,{setFilterBy:_,itemsQuantity:v!==m.ALL?R.length:n.length,filterBy:v,onClear:ae,completedLength:ce.length})]}):null]}),Object(g.jsx)(E,{onClose:function(e){return j(e)},error:d})]}):Object(g.jsx)(T,{setUser:Z})};s.a.render(Object(g.jsx)(S,{}),document.getElementById("root"))}},[[20,1,2]]]);
//# sourceMappingURL=main.bfbea390.chunk.js.map